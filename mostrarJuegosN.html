<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagina principal</title>
    <link rel="stylesheet" type="text/css" href="mostrarJuego.css">
</head>

<body onload="obtenerJuego()  ">

    <div id="linea"></div>
    <div id="header">
        <div>

            <a class="boton2" href="index.html">Cerrar Sesion</a>


        </div>
        <div id="centro1">

            <div id=logo>
                <h2>Tienda de juegos</h2>
                <p>Diversión sin límite</p>
            </div>

            <div id="menu">
                <ul>
                    <li><a href="Principal3.html">Inicio</a></li>

                    <li><a href="">Contacto</a></li>
                </ul>
            </div>

        </div>

    </div>
    <div id="presentacion">
        <div id="centro2">
            <div id="izquierda">
                <h2>Bienvenidos a game store</h2>
                <p class="decripcion-pres">La tienda virtual mas grande de video juegos</p>
                <button class="boton">Mas informacion</button>
            </div>
            <div id="derecha">
                <img src="https://www.magisnet.com/wp-content/uploads/2020/04/Videojuegos.jpg" class="img">
                <div id="categoria">
                    <select id="miselect">
                        <option value="">Sleeciona</option>
                        <option value="1">valor1</option>
                        <option value="2">valor2</option>
                        <option value="3">valor3</option>
                    </select>

                    <input for="texto" type="text" placeholder="Buscar">
                    <button id="botonBuscar">Buscar</button>
                </div>
            </div>


        </div>

    </div>

    <div id="menuU">

        <div id="centro3">
            <div id="menu2">
                <ul>
                    <li><a href="CatalagoCliente.html">Catalogo de videojuegos</a></li>
                    

                </ul>
            </div>
        </div>
    </div>

    <div id="cuerpo">
        <div id="mostrarBanner">

        </div>
        <div id="mostrarImagen">

        </div>

        <div id="mostrarInfo">

        </div>

    </div>

    <div id="comentarios">
        <div id="linea2">
            <h2 style="text-align: center;">Comentarios:</h2>
        </div>
        <div>
            <div id="agregarComentario">
                
            </div>
        </div>
        <div id="tabla">


            <table id="tablita">
            </table>




        </div>

    </div>

    <script>
        function obtenerJuego() {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const id = urlParams.get('idJuego')

            window.alert(id)

            fetch("http://127.0.0.1:9000/mostrarJuego", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "id": id

                })

            }).then(res => res.json())
                .catch(err => {
                    console.log(err)
                })
                .then(response => {


                    console.log(response.nombre)
                    window.alert("Listo")
                    var colocarBanner = document.querySelector('#cuerpo #mostrarBanner')
                    var colocarImagen = document.querySelector('#cuerpo #mostrarImagen')
                    var colocarInfo = document.querySelector('#cuerpo #mostrarInfo')
                    colocarBanner.innerHTML = ` <img id="banner" src="${response.banner}" alt="">`
                    colocarImagen.innerHTML = `
                                    <h1>Detalle</h1>
                                    <img id=imagen src="${response.foto}" alt="">`

                    colocarInfo.innerHTML += `  <h2>${response.nombre}</h2>
                                    <label id="categorias" for="texto">${response.categoria1}   </label>
                                    <label id="categorias" for="texto"> ${response.categoria2}</label>
                                    <label id="categorias" for="texto"> ${response.categoria3}</label><br>
                                    <label id="precio" for="texto">Q.${response.precio} </label><br>
                                    <label id="descripcion" for="texto">${response.descripcion} </label><br>
                                    `
                                    obtenerComentarios()
                })
                

        }

       


        function obtenerComentarios() {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const id = urlParams.get('idJuego')
           
            fetch("http://127.0.0.1:9000/mostrarComentario", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "id": id



                })

            }).then(res => res.json())
                .catch(err => {
                    console.log(err)
                })
                .then(response => {
                    var datos = response

                    console.log(datos)
                    var colocarDatos = document.querySelector('#comentarios #tablita')
                    if (datos == null) {
                        console.log("no hay nada")
                    } else {
                        console.log(datos)
                       
                            datos.forEach(element => {
                                if (id == element.id) {
                                console.log("Este es el id" + element.id )
                                console.log("Este el el nombre"+element.idU)
                                
                                colocarDatos.innerHTML += `
 

                                            <tr >
                                        <th id="nombre" >
                                            ${element.idU}
                                        </th>
                                 <th id="com1">Comentario:</th>

                                 </tr><br>
                                    <tr>
                                  <th id="fecha">
                                ${element.fecha}
                                 </th>
                                 <th id="com">
                                    ${element.comentario}
                                  </th>
                               </tr>

                                           `
                           

                        }
                    });

                    }

                })

        }
        
       //Funcion para agregar un juego a la biblioteca

       function agregarABibliote() {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const idJ = urlParams.get('idJuego')  
        var idU=sessionStorage.getItem("id")
        fetch("http://127.0.0.1:9000/agregarAbiblioteca", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "idU": idU,
                    "idJ": idJ



                })

            }).then(res => res.json())
                .catch(err => {
                    console.log(err)
                })
                .then(response => {
                    var datos = response
                    window.alert("Juego"+datos.id +" agregado")

                    
                    

                })
       }

    </script>

</body>


</html>